#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)

require 'rubygems'
require 'trollop'
require 'yarn'

opts = Trollop::options do
  version "Yarn v#{Yarn::VERSION} 2011 Jesper Kjeldgaard"
  banner <<-EOS
Yarn v#{Yarn::VERSION} is a multithreaded webserver written in Ruby 1.9.2
To use Yarn to serve Rack applications run: rackup -s Yarn <rackup file (config.ru)>

Usage: yarn [options]
where [options] are:
EOS

  opt :host, "Hostname or IP address of the server", :default => "127.0.0.1"
  opt :port, "Port number to listen on for incomming requests", :default => 3000
  opt :workers, "Number of worker threads", :default => "32"
end

server = Yarn::Server.new(nil,opts)
server.start
